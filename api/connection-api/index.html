



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="The WakaamaNode (lwM2M library) documentation.">
      
      
        <link rel="canonical" href="https://Openhab-Nodes.github.io/wakaamaNode/api/connection-api/">
      
      
        <meta name="author" content="David Gräff">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.3">
    
    
      
        <title>Connection API - WakaamaNode</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.8d40d89b.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="red" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#connectiondevicefirmware-api" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://Openhab-Nodes.github.io/wakaamaNode/" title="WakaamaNode" class="md-header-nav__button md-logo">
          
            <img src="../../assets/logo_s.webp" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                WakaamaNode
              </span>
              <span class="md-header-nav__topic">
                Connection API
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Openhab-Nodes/wakaamaNode/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Openhab-Nodes/wakaamaNode
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." title="Home" class="md-tabs__link">
          Home
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../quickstart/getting-started/" title="Quickstart/Download" class="md-tabs__link">
          Quickstart/Download
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" title="Connection API" class="md-tabs__link md-tabs__link--active">
          Connection API
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../about/" title="Objects API" class="md-tabs__link">
          Objects API
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../advanced-usage/custom-platform/" title="Advanced usage" class="md-tabs__link">
          Advanced usage
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../examples/" title="Examples" class="md-tabs__link">
          Examples
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../assets/logo_s.webp" width="48" height="48">
      
    </span>
    WakaamaNode
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Openhab-Nodes/wakaamaNode/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Openhab-Nodes/wakaamaNode
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Home
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Home
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Lightweight M2M library" class="md-nav__link">
      Lightweight M2M library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../testing/" title="Testing" class="md-nav__link">
      Testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../legal_notice/" title="Legal notice" class="md-nav__link">
      Legal notice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../privacy_policy/" title="Privacy policy" class="md-nav__link">
      Privacy policy
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Quickstart/Download
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Quickstart/Download
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../quickstart/getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Connection API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Connection API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Connection API
      </label>
    
    <a href="./" title="Connection API" class="md-nav__link md-nav__link--active">
      Connection API
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connection-c-api" title="Connection C-API" class="md-nav__link">
    Connection C-API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connection-c-api_1" title="Connection C++-API" class="md-nav__link">
    Connection C++-API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-information-api" title="Device information API" class="md-nav__link">
    Device information API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firmware-update-ota" title="Firmware update / OTA" class="md-nav__link">
    Firmware update / OTA
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-method" title="Update method" class="md-nav__link">
    Update method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-api" title="C++ API" class="md-nav__link">
    C++ API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_3" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Objects API
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Objects API
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../about/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects-registry/" title="Registry objects" class="md-nav__link">
      Registry objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects-custom/" title="Custom objects" class="md-nav__link">
      Custom objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects-custom-cpp-example/" title="Custom objects /CPP Example" class="md-nav__link">
      Custom objects /CPP Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects-custom-c-example/" title="Custom objects /C Example" class="md-nav__link">
      Custom objects /C Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Advanced usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Advanced usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/custom-platform/" title="Custom platform" class="md-nav__link">
      Custom platform
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/custom-network/" title="Custom network stack" class="md-nav__link">
      Custom network stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/ota/" title="Over-the-air updates" class="md-nav__link">
      Over-the-air updates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/deep-sleep/" title="Deep sleep" class="md-nav__link">
      Deep sleep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/own-mainloop/" title="Own mainloop" class="md-nav__link">
      Own mainloop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/thread-safety/" title="Thread safety" class="md-nav__link">
      Thread safety
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced-usage/memory/" title="Memory" class="md-nav__link">
      Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../others/limitations-and-known-issues/" title="Limitations" class="md-nav__link">
      Limitations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../others/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connection-c-api" title="Connection C-API" class="md-nav__link">
    Connection C-API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connection-c-api_1" title="Connection C++-API" class="md-nav__link">
    Connection C++-API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_1" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-information-api" title="Device information API" class="md-nav__link">
    Device information API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example_2" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#firmware-update-ota" title="Firmware update / OTA" class="md-nav__link">
    Firmware update / OTA
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#update-method" title="Update method" class="md-nav__link">
    Update method
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-api" title="C++ API" class="md-nav__link">
    C++ API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_3" title="Example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Openhab-Nodes/wakaamaNode/edit/master/docs/api/connection-api.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="connectiondevicefirmware-api">Connection/Device/Firmware API</h1>
<p>Find the documentation and examples for the connection C and C++ API in this document.
The last sections describe the device- and firware update API.</p>
<h2 id="connection-c-api">Connection C-API</h2>
<p>Include <code class="codehilite">lwm2m/c_connect.h</code>.</p>
<p>In your main file declare a variable of type <code class="codehilite">lwm2m_client_context_t</code>.</p>
<div class="admonition example">
<p class="admonition-title">Define a long living client context variable</p>
<p><code class="codehilite"><span class="n">lwm2m_client_context_t</span> <span class="n">context</span><span class="p">;</span></code></p>
</div>
<p>This type contains the lwm2m context of type <code class="codehilite">lwm2m_context_t</code>, that is required for most API calls.
Usually you do not need to access any of the member fields directly.</p>
<p>Because it is so common to extract the <code class="codehilite">lwm2m_context_t*</code>, there is the <code class="codehilite">CTX(context)</code> macro doing this for you.</p>
<div class="admonition example">
<p class="admonition-title">Example on how to use CTX</p>
<div class="codehilite"><pre><span></span><span class="n">lwm2m_client_context_t</span> <span class="n">context</span><span class="p">;</span>
<span class="n">lwm2m_process</span><span class="p">(</span><span class="n">CTX</span><span class="p">(</span><span class="n">context</span><span class="p">));</span>
</pre></div>

</div>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param context Wakaama client context. May not be NULL.</span>
<span class="cm"> * @param endpointName The server uses this name to identify a client over multiple sessions</span>
<span class="cm"> * @return Return 0 if socket binding failed. Otherwise returns the number</span>
<span class="cm"> *     of sockets the method could bind to (for IPv4 and IPv6 each on all available interfaces).</span>
<span class="cm"> */</span>
<span class="kt">uint8_t</span> <span class="nf">lwm2m_client_init</span><span class="p">(</span><span class="n">lwm2m_client_context_t</span><span class="o">*</span> <span class="n">context</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">endpointName</span><span class="p">);</span>
</pre></div>

<p>Initialize the given wakaame client context and the network module.
Close the client context with <code class="codehilite">lwm2m_client_close()</code>.</p>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param context Wakaama client context. May not be NULL.</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">lwm2m_client_close</span><span class="p">(</span><span class="n">lwm2m_client_context_t</span><span class="o">*</span> <span class="n">context</span><span class="p">);</span>
</pre></div>

<p>Close the given wakaama client context.</p>
<p>Will release dynamically aquired ressources and calls lwm2m_network_close().
All added servers are gone after this call.
This will not release objects created by lwm2m_object_create.</p>
<p><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> * @param next_event Returns a timeval value that tells you when the next call is due.</span>
<span class="cm"> * It does not modify timeval if it already has a value that is sooner than the next due time.</span>
<span class="cm"> * @return Returns a wakaama error code (the result value of lwm2m_step())</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="nf">lwm2m_process</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span> <span class="n">contextP</span><span class="p">,</span> <span class="k">struct</span> <span class="n">timeval</span><span class="o">*</span> <span class="n">next_event</span><span class="p">);</span>
</pre></div>
Call this method periodically. Internally it will process new network packages as well as progress in the wakaamas state machine.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>On Posix Systems you can call <code class="codehilite">lwm2m_block_wait(context, next_event)</code> to wait for
either received network packets or for the due time of the next event.</p>
</div>
<p><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> * @param next_event Uses and returns a timeval value that tells you when the next call is due.</span>
<span class="cm"> * It does not modify timeval if it already has a value that is sooner than the next due time.</span>
<span class="cm"> * @param reconnectTime Reconnect time in seconds</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">lwm2m_watch_and_reconnect</span><span class="p">(</span><span class="n">wm2m_context_t</span> <span class="o">*</span> <span class="n">contextP</span><span class="p">,</span> <span class="k">struct</span> <span class="n">timeval</span><span class="o">*</span> <span class="n">next_event</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reconnectTime</span><span class="p">);</span>
</pre></div>
Watch server connections and reset the lwm2m state machine to force reconnects,
if the current state is STATE_BOOTSTRAP_REQUIRED. Usually you want to call this after <code class="codehilite">lwm2m_process</code>
for automatic reconnection.</p>
<p><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> * @param shortServerID A unique server id</span>
<span class="cm"> * @param uri The server URI</span>
<span class="cm"> * @param lifetime A lifetime in seconds</span>
<span class="cm"> * @param storing If notifications should be stored and resend if a server connection was interruppted and then reconnected.</span>
<span class="cm"> * @return Return true if successfully added and false if aborted due to no memory.</span>
<span class="cm"> */</span>
<span class="kt">bool</span> <span class="nf">lwm2m_add_server</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">contextP</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">shortServerID</span><span class="p">,</span>
                      <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">uri</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">lifetime</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">storing</span><span class="p">);</span>
</pre></div>
Adds a new server to the lwm2m client. The client statemachine will try to connect to this
server with the next iteration (usually caused by calling <code class="codehilite">lwm2m_process()</code>).</p>
<p><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP A Wakaama client context</span>
<span class="cm"> * @param shortServerID A unique server id</span>
<span class="cm"> * @param publicId publicIdentity for DTLS. May be NULL if no secure connection is used.</span>
<span class="cm"> * The expected c-string is copied to a new memory location.</span>
<span class="cm"> * @param psk Passkey if DTLS is used. May be NULL. The byte array is copied to a new memory location.</span>
<span class="cm"> * @param pskLen Passkey length. Should be 0 if no passkey is used.</span>
<span class="cm"> * @return Return true if successfully added and false if aborted due to no memory.</span>
<span class="cm"> */</span>
<span class="kt">bool</span> <span class="nf">lwm2m_use_dtls_psk</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">contextP</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">shortServerID</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">publicId</span><span class="p">,</span>
                        <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">psk</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pskLen</span><span class="p">);</span>
</pre></div>
Alters a servers security details by adding preshared key DTLS information. Call this before entering the
main loop (<code class="codehilite">lwm2m_process()</code>).
You may also remove DTLS information by providing a NULL argument to psk and publicid.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have specified a "coap://" URI in lwm2m_add_server(...), then
publicId and psk will be set to NULL on a connection attempt.</p>
</div>
<p>The LwM2M specification V1.0 says:</p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>Since the security of the default PSK Cipher Suites
rely on the length and the entropy of this shared secret
it is RECOMMENDED to provision a 16 byte (128 bit) key".</p>
</div>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> * @param security_instance_id The security instance id which refers to a specific server</span>
<span class="cm"> */</span>
<span class="kt">bool</span> <span class="nf">lwm2m_unregister_server</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">contextP</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">security_instance_id</span><span class="p">);</span>
</pre></div>

<p>Informs the lwm2m server about a disconnect and flags the connection as disconnected.
Disconnected servers are still available until <code class="codehilite">lwm2m_remove_unregistered_servers</code> is called.</p>
<p><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">lwm2m_remove_unregistered_servers</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">contextP</span><span class="p">);</span>
</pre></div>
Removes all unregistered server, by removing all related security objects.
Puts the client back to STATE_INITIAL if the server list has been altered.</p>
<p><div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> * @param security_instance_id The security instance id which refers to a specific server</span>
<span class="cm"> */</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">lwm2m_get_server_uri</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">contextP</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">shortServerID</span><span class="p">);</span>
</pre></div>
Returns the uri of a server by providing the security object id of that server connection.</p>
<p>The c-string is not copied and valid as long as the respective security object is alive.</p>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param contextP Wakaama context</span>
<span class="cm"> */</span>
<span class="kt">bool</span> <span class="nf">lwm2m_is_connected</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">contextP</span><span class="p">);</span>
</pre></div>

<p>Return true if wakaama is connected to a lwm2m server.</p>
<h3 id="example">Example</h3>
<p>To setup the library, you would follow the outlined schema of the following C code:</p>
<div class="codehilite"><pre><span></span><span class="c1">// The client name will be used by the lwm2m server for identification.</span>
<span class="n">lwm2m_client_context_t</span> <span class="nf">context</span><span class="p">(</span><span class="s">&quot;testClient&quot;</span><span class="p">);</span>
<span class="c1">// Posix and Lwip network support is implemented.</span>
<span class="n">lwm2m_client_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">);</span>

<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// Call the lwm2m state machine (lwm2m_process) periodically. </span>
   <span class="c1">// tv will be used as output variable.</span>
   <span class="c1">// The library tells us about the next required call to lwm2m_process().</span>
   <span class="c1">// In this simple example we ignore this request.</span>
   <span class="k">struct</span> <span class="n">timeval</span> <span class="n">tv</span> <span class="o">=</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
   <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">lwm2m_process</span><span class="p">(</span><span class="n">CTX</span><span class="p">(</span><span class="n">context</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">tv</span><span class="p">);</span>
   <span class="c1">// Error handling of `result`.</span>
<span class="p">}</span>

<span class="c1">// Deregisters from the lwm2m server, frees ressources taken by wakaama.</span>
<span class="c1">// Also closes the network connection and release network ressoures.</span>
<span class="n">lwm2m_client_close</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">);</span>
</pre></div>

<h2 id="connection-c-api_1">Connection C++-API</h2>
<p>The C++ API is only a slim wrapper around the C API.
All methods are named the same (expect the missing <code class="codehilite">lwm2m_</code> prefix)
and have the same signature as their C-equivalent,
except that no <code class="codehilite">lwm2m_context_t</code> need to be passed.</p>
<p>Include <code class="codehilite">lwm2m/connect.h</code>.</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">LwM2MConnect</span> <span class="o">:</span> <span class="k">public</span> <span class="n">lwm2m_client_context_t</span> <span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">LwM2MConnect</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">endpointName</span><span class="p">);</span>
    <span class="o">~</span><span class="n">LwM2MConnect</span><span class="p">();</span>

    <span class="kt">int</span> <span class="nf">process</span><span class="p">(</span><span class="k">struct</span> <span class="n">timeval</span><span class="o">*</span> <span class="n">next_event</span><span class="p">);</span>

    <span class="kt">int</span> <span class="nf">block_wait</span><span class="p">(</span><span class="k">struct</span> <span class="n">timeval</span> <span class="n">next_event</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">watch_and_reconnect</span><span class="p">(</span><span class="k">struct</span> <span class="n">timeval</span><span class="o">*</span> <span class="n">next_event</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reconnectTime</span><span class="p">);</span>

    <span class="kt">bool</span> <span class="nf">add_server</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">shortServerID</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">uri</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">lifetime</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">storing</span><span class="p">);</span>

    <span class="kt">bool</span> <span class="nf">use_dtls_psk</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">shortServerID</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">publicId</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">psk</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pskLen</span><span class="p">);</span>

    <span class="kt">bool</span> <span class="nf">unregister_server</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">security_instance_id</span><span class="p">);</span>

    <span class="kt">void</span> <span class="nf">remove_unregistered_servers</span><span class="p">();</span>

    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="nf">get_server_uri</span><span class="p">(</span><span class="kt">uint16_t</span> <span class="n">shortServerID</span><span class="p">);</span>

    <span class="kt">bool</span> <span class="nf">is_connected</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>

<h3 id="example_1">Example</h3>
<p>To setup the library, you would follow the outlined schema of the following CPP code:</p>
<div class="codehilite"><pre><span></span><span class="n">LwM2MConnect</span> <span class="nf">context</span><span class="p">(</span><span class="s">&quot;testClient&quot;</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">timeval</span> <span class="n">tv</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
   <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">process</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tv</span><span class="p">);</span>
   <span class="cp">#ifdef POSIX_NETWORK</span>
   <span class="n">context</span><span class="p">.</span><span class="n">block_wait</span><span class="p">(</span><span class="n">tv</span><span class="p">);</span>
   <span class="cp">#endif</span>
<span class="p">}</span>
</pre></div>

<h2 id="device-information-api">Device information API</h2>
<p>The library implements the lwm2m device object for you.</p>
<blockquote>
<p>The Device Object provides an optional device reboot and factory reset function as well as a range of device related information which can be queried by the LWM2M Server.</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * @param res_id The ressource id of the value you have changed in device_instance_t.</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="nf">lwm2m_device_res_has_changed</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">res_id</span><span class="p">);</span>
</pre></div>

<p>Call this if you have changed a ressource of the <code class="codehilite">device_instance_t</code> object.
You only have to do this after you have connected to a lwm2m server.</p>
<p>To change a device information (version number etc), do the following:
<div class="codehilite"><pre><span></span><span class="n">lwm2m_client_context_t</span> <span class="n">context</span><span class="p">;</span> <span class="c1">// Your global client context variable</span>

<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">firmware_ver</span> <span class="o">=</span> <span class="s">&quot;1.2&quot;</span><span class="p">;</span>
<span class="c1">// Only do this if you have called lwm2m_process at least once already</span>
<span class="n">lwm2m_device_res_has_changed</span><span class="p">(</span><span class="n">CTX</span><span class="p">(</span><span class="n">context</span><span class="p">),</span> <span class="n">RES_O_FIRMWARE_VERSION</span><span class="p">);</span>
</pre></div></p>
<p>The following device information are obtained by calling a function:</p>
<table>
<thead>
<tr>
<th>ResID</th>
<th align="center">Name</th>
<th align="center">Configuration option</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>9</td>
<td align="center">Battery level</td>
<td align="center">LWM2M_DEVICE_INFO_WITH_BATTERY</td>
<td>uint8_t lwm2m_get_bat_level()</td>
</tr>
<tr>
<td>20</td>
<td align="center">Battery status</td>
<td align="center">same</td>
<td>uint8_t lwm2m_get_bat_status</td>
</tr>
<tr>
<td>10</td>
<td align="center">Free memory</td>
<td align="center">LWM2M_DEVICE_INFO_WITH_MEMINFO</td>
<td>int64_t lwm2m_get_free_mem()</td>
</tr>
<tr>
<td>21</td>
<td align="center">Total memory</td>
<td align="center">same</td>
<td>int64_t lwm2m_get_total_mem()</td>
</tr>
<tr>
<td>11</td>
<td align="center">Last error code</td>
<td align="center">LWM2M_DEVICE_INFO_WITH_ERRCODE</td>
<td>int64_t lwm2m_get_last_error()</td>
</tr>
<tr>
<td>13</td>
<td align="center">Current time (s)</td>
<td align="center"></td>
<td>int64_t lwm2m_gettime()</td>
</tr>
</tbody>
</table>
<p>You need to implement the corresponding function if you enable the respective configuration option.</p>
<div class="admonition info">
<p class="admonition-title">Notify the server about a new value</p>
<p><code class="codehilite">lwm2m_device_res_has_changed(CTX(context), RES_O_BATTERY_LEVEL)</code></p>
</div>
<p>Some configuration options require you to implement further functions, see the table below:</p>
<table>
<thead>
<tr>
<th>ResID</th>
<th align="center">Name</th>
<th align="center">Configuration option</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td align="center">Reboot device</td>
<td align="center">LWM2M_DEVICE_WITH_REBOOT</td>
<td>void lwm2m_reboot()</td>
</tr>
<tr>
<td>5</td>
<td align="center">Factory reset</td>
<td align="center">LWM2M_DEVICE_WITH_FACTORY_RESET</td>
<td>void lwm2m_factory_reset()</td>
</tr>
</tbody>
</table>
<h3 id="example_2">Example</h3>
<p>You may want to provide some c-strings stating the manufacturer, the model_name, device_type,
firmware version and a serial number, before you connect to a lwm2m server.
You would do this like in the following example:</p>
<div class="codehilite"><pre><span></span><span class="c1">// C-API</span>
<span class="n">lwm2m_client_context_t</span> <span class="n">context</span><span class="p">;</span>
<span class="n">lwm2m_client_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">,</span> <span class="s">&quot;testClient&quot;</span><span class="p">);</span>

<span class="c1">// C++ API</span>
<span class="n">LwM2MConnect</span> <span class="n">context</span><span class="p">;</span>

<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">manufacturer</span> <span class="o">=</span> <span class="s">&quot;test manufacturer&quot;</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">model_name</span> <span class="o">=</span> <span class="s">&quot;test model&quot;</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">device_type</span> <span class="o">=</span> <span class="s">&quot;sensor&quot;</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">firmware_ver</span> <span class="o">=</span> <span class="s">&quot;1.0&quot;</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">serial_number</span> <span class="o">=</span> <span class="s">&quot;140234-645235-12353&quot;</span><span class="p">;</span>
<span class="c1">// if LWM2M_DEV_INFO_TIME is enabled</span>
<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">time_offset</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">context</span><span class="p">.</span><span class="n">deviceInstance</span><span class="p">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="s">&quot;+05:00&quot;</span><span class="p">;</span>
</pre></div>

<div class="admonition info">
<p class="admonition-title">Info</p>
<p>If you change data after you have connected to a server, you need to call
<code class="codehilite">lwm2m_device_res_has_changed(context, res_id)</code> after the change.</p>
</div>
<h2 id="firmware-update-ota">Firmware update / OTA</h2>
<p>To enable OTA, define LWM2M_FIRMWARE_UPGRADES in <code class="codehilite">config_wakama.h</code>.</p>
<p>An implementation exist for posix/win32 systems and for Arduino OTA compliant platforms.</p>
<h3 id="update-method">Update method</h3>
<p>There are generally two methods for updating.</p>
<ul>
<li>
<p>The Http(s) method signals the lwM2M server that a URL should be provided where the new firmware can be found.
  Use UPDATE_PROTOCOL_HTTP or UPDATE_PROTOCOL_HTTPS for the <code class="codehilite">FirmwareUpdate</code> constructor.</p>
</li>
<li>
<p>The Coap(s) method makes the server send the new firmware via coap as an opaque data chunk.
  Because that data chunk is expected to be huge and need to be memory buffered, small µC probably do not support this method.
  Use UPDATE_PROTOCOL_COAP or UPDATE_PROTOCOL_COAPS for the <code class="codehilite">FirmwareUpdate</code> constructor.</p>
</li>
</ul>
<h3 id="c-api">C++ API</h3>
<p>Include the <code class="codehilite">firmware.h</code> file and create an object of <code class="codehilite">FirmwareUpdate</code>.</p>
<div class="codehilite"><pre><span></span><span class="cm">/**</span>
<span class="cm">* Creates a firmware update object.</span>
<span class="cm">*</span>
<span class="cm">* @param context A lwm2m context</span>
<span class="cm">* @param app_version The current APP version</span>
<span class="cm">*/</span>
<span class="n">FirmwareUpdate</span><span class="o">::</span><span class="n">FirmwareUpdate</span><span class="p">(</span><span class="n">lwm2m_context_t</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">app_version</span><span class="p">,</span>
    <span class="n">lwm2m_update_protocol</span> <span class="n">protocol</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm">* Only for POSIX compatible systems.</span>
<span class="cm">* Check if this executable is the new updated one.</span>
<span class="cm">* If this is the new one:</span>
<span class="cm">* Waits for the old executable to finish. We expect a</span>
<span class="cm">* command line parameter &quot;oldexe=PID&quot; with the PID of the</span>
<span class="cm">* old executable. To notify the old executable about our</span>
<span class="cm">* successful start up, a POSIX signal USR1 is send.</span>
<span class="cm">*</span>
<span class="cm">* @param argc Command line argument count</span>
<span class="cm">* @param argv Command line arguments</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="n">FirmwareUpdate</span><span class="o">::</span><span class="n">checkIsUpdated</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm">* Call this in your main loop to check for new updates,</span>
<span class="cm">* initiate the download and restart if necessary</span>
<span class="cm">*/</span>
<span class="kt">void</span> <span class="n">FirmwareUpdate</span><span class="o">::</span><span class="n">process</span><span class="p">();</span>
</pre></div>

<h3 id="example_3">Example</h3>
<div class="codehilite"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;lwm2m/firmware.h&quot;</span><span class="cp"></span>
<span class="n">LwM2MConnect</span> <span class="n">context</span><span class="p">;</span>
<span class="n">FirmwareUpdate</span> <span class="nf">firmwareUpdate</span><span class="p">(</span><span class="n">CTX</span><span class="p">(</span><span class="n">context</span><span class="p">),</span> <span class="s">&quot;1.0&quot;</span><span class="p">,</span> <span class="n">UPDATE_PROTOCOL_HTTP</span><span class="p">);</span>

<span class="p">...</span>

<span class="kt">void</span> <span class="n">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">context</span><span class="p">.</span><span class="n">process</span><span class="p">(...);</span>
    <span class="n">firmwareUpdate</span><span class="p">.</span><span class="n">process</span><span class="p">();</span>
<span class="p">}</span>
<span class="p">...</span>
<span class="c1">// if POSIX</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">firmwareUpdate</span><span class="p">.</span><span class="n">checkIsUpdated</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">);</span>
    <span class="p">...</span>
    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">loop</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
                
                  
                
              
              
                


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://Openhab-Nodes.github.io/wakaamaNode/api/connection-api/";
      this.page.identifier =
        "api/connection-api/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//https-openhab-nodes-github-io-wakaamanode.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <span class="md-footer-copyright__highlight">
            Copyright 2017-2018 © David Gräff.
          </span>
        
      </div>
      <div style="float:right">
      <a href="/legal_notice/">Legal Notice</a>|
      <a href="/privacy_policy/">Privacy Policy</a>
      </div>
    </div>
  </div>
</footer> 
      
    </div>
    
      <script src="../../assets/javascripts/application.b438e6c5.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>